# Generated by Codex on 2026-02-06

import django.db.models.deletion
from django.db import migrations, models


def _copy_results(source_model, target_model):
    if source_model.objects.exists() and not target_model.objects.exists():
        target_model.objects.bulk_create(
            [
                target_model(
                    id=item.id,
                    student_id=item.student_id,
                    subject_id=item.subject_id,
                    exam_id=item.exam_id,
                    marks=item.marks,
                    grade=item.grade,
                    point=item.point,
                )
                for item in source_model.objects.all()
            ]
        )


def forward_copy(apps, schema_editor):
    CoreResult = apps.get_model('core', 'Result')
    Result = apps.get_model('results', 'Result')
    _copy_results(CoreResult, Result)


def reverse_copy(apps, schema_editor):
    CoreResult = apps.get_model('core', 'Result')
    Result = apps.get_model('results', 'Result')
    _copy_results(Result, CoreResult)


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0006_move_feature_models'),
        ('results', '0001_initial'),
    ]

    operations = [
        migrations.RunPython(forward_copy, reverse_copy),
        migrations.DeleteModel(
            name='Result',
        ),
    ]
